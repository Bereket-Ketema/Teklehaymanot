<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Latest News</title>
  <link rel="stylesheet" href="css/post.css" />
</head>
<body>

  <!-- Lightbox container -->
  <div id="lightbox" onclick="hideLightbox()">
    <img id="lightbox-img" src="" alt="Full Size">
  </div>

  <div class="container">
    <h2>ðŸ“° áŠ á‹³á‹²áˆµ áˆ˜áˆ¨áŒƒá‹Žá‰½</h2>
    <div id="newsContainer" class="news-list"></div>
  </div>

  <script>
    function showLightbox(src) {
      const img = document.getElementById('lightbox-img');
      img.src = src;
      document.getElementById('lightbox').style.display = 'flex';
    }

    function hideLightbox() {
      document.getElementById('lightbox').style.display = 'none';
    }

    // âœ… Only one fetch call
    fetch('/news')
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('newsContainer');
        const shown = new Set(); // optional deduplication

        data.forEach(news => {
          if (shown.has(news.id)) return; // prevent duplicates by ID
          shown.add(news.id);

          const div = document.createElement('div');
          div.classList.add('news-item');
          div.innerHTML = `
            <h3>${news.title}</h3>
            <img src="${news.image}" alt="News Image" onclick="showLightbox('${news.image}')">
            <p>${news.content}</p>
            <small>${new Date(news.created_at).toLocaleString()}</small>
          `;
          container.appendChild(div);
        });
      })
      .catch(err => console.error('Failed to load news:', err));
  </script>

</body>
</html>
